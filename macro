-- 🧩 Load Rayfield
local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()

-- 🌌 Tạo cửa sổ chính
local Window = Rayfield:CreateWindow({
    Name = "SDVT SAB",
    LoadingTitle = "SDVT Hub",
    LoadingSubtitle = "Auto Script",
    ConfigurationSaving = {
        Enabled = true,
        FolderName = "SDVT",
        FileName = "SDVTSAB"
    }
})

local player = game.Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local humanoid = character:WaitForChild("Humanoid")

-- ========================
-- 📜 TAB 1: INFO
-- ========================
local InfoTab = Window:CreateTab("📜 Info", 4483362458)
InfoTab:CreateSection("👤 Thông tin người dùng")
InfoTab:CreateLabel("Tên người dùng: " .. player.Name)
InfoTab:CreateLabel("UserID: " .. player.UserId)
InfoTab:CreateLabel("Game ID: " .. game.PlaceId)
InfoTab:CreateLabel("Mô tả: Đây là Script Hub SDVT - hỗ trợ auto & tiện ích Roblox")

-- ========================
-- 🧭 TAB 2: MAIN
-- ========================
local MainTab = Window:CreateTab("🧭 Main", 4483362458)
MainTab:CreateSection("📌 Hệ thống Auto")

-- ⚙️ Auto Buy Noobini Pizzanini
local autoBuy = false

local function findNoobini()
	for _, obj in ipairs(workspace:GetDescendants()) do
		if obj:IsA("Model") and obj.Name == "Noobini Pizzanini" then
			return obj
		end
	end
end

local function simulateKeyPress(key)
	local VirtualInputManager = game:GetService("VirtualInputManager")
	VirtualInputManager:SendKeyEvent(true, key, false, game)
	task.wait(0.1)
	VirtualInputManager:SendKeyEvent(false, key, false, game)
end

MainTab:CreateToggle({
	Name = "🍕 Auto Buy Noobini Pizzanini",
	CurrentValue = false,
	Flag = "AutoBuyNoobini",
	Callback = function(value)
		autoBuy = value
		if value then
			Rayfield:Notify({
				Title = "✅ Auto Buy Bắt đầu",
				Content = "Đang tự tìm và mua Noobini Pizzanini...",
				Duration = 3
			})
			task.spawn(function()
				while autoBuy do
					local npc = findNoobini()
					if npc and npc:FindFirstChild("HumanoidRootPart") then
						local targetPos = npc.HumanoidRootPart.Position
						local distance = (character:WaitForChild("HumanoidRootPart").Position - targetPos).Magnitude

						if distance > 8 then
							humanoid:MoveTo(targetPos)
							humanoid.MoveToFinished:Wait()
						else
							-- Khi đã đủ gần → nhấn phím E để mua
							simulateKeyPress(Enum.KeyCode.E)
							task.wait(3) -- đợi 3 giây giữa các lần mua
						end
					else
						task.wait(1) -- nếu chưa tìm thấy NPC
					end
					task.wait(0.2)
				end
			end)
		else
			Rayfield:Notify({
				Title = "⏹ Auto Buy Tắt",
				Content = "Đã dừng Auto Buy Noobini Pizzanini.",
				Duration = 2
			})
		end
	end
})

-- 🔁 Auto Load Config
Rayfield:Notify({
	Title = "📂 SDVT Auto Load",
	Content = "Đã tự động tải menu SDVTSAB.",
	Duration = 3
})
