--// ================================
--// Script Auto Loader + UI Status + Fix Lag + Anti-Kick
--// By SDVT & ChatGpt
--// ================================

-- Đếm số lần chạy
if not getgenv().RunCount then
    getgenv().RunCount = 1
else
    getgenv().RunCount += 1
end

--// ================================
--// UI góc phải (hiện trước khi load)
--// ================================
local Players = game:GetService("Players")
local player = Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")

if playerGui:FindFirstChild("RunStatusGui") then
    playerGui.RunStatusGui:Destroy()
end

local ScreenGui = Instance.new("ScreenGui", playerGui)
ScreenGui.Name = "RunStatusGui"
ScreenGui.ResetOnSpawn = false

local Frame = Instance.new("Frame", ScreenGui)
Frame.Size = UDim2.new(0, 260, 0, 105)
Frame.Position = UDim2.new(1, -270, 1, -150)
Frame.BackgroundColor3 = Color3.fromRGB(15, 15, 15)
Frame.BackgroundTransparency = 0.15
Frame.BorderSizePixel = 0
Instance.new("UICorner", Frame).CornerRadius = UDim.new(0, 12)
local stroke = Instance.new("UIStroke", Frame)
stroke.Thickness = 1.5
stroke.Color = Color3.fromRGB(0, 255, 127)

local RunLabel = Instance.new("TextLabel", Frame)
RunLabel.Size = UDim2.new(1, -10, 0, 20)
RunLabel.Position = UDim2.new(0, 5, 0, 5)
RunLabel.BackgroundTransparency = 1
RunLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
RunLabel.Text = "Run #" .. tostring(getgenv().RunCount)
RunLabel.TextXAlignment = Enum.TextXAlignment.Left
RunLabel.Font = Enum.Font.GothamBold
RunLabel.TextSize = 15

local PingLabel = Instance.new("TextLabel", Frame)
PingLabel.Size = UDim2.new(1, -10, 0, 20)
PingLabel.Position = UDim2.new(0, 5, 0, 25)
PingLabel.BackgroundTransparency = 1
PingLabel.TextColor3 = Color3.fromRGB(0, 255, 127)
PingLabel.Text = "Ping: ..."
PingLabel.TextXAlignment = Enum.TextXAlignment.Left
PingLabel.Font = Enum.Font.Gotham
PingLabel.TextSize = 15

local StatusLabel = Instance.new("TextLabel", Frame)
StatusLabel.Size = UDim2.new(1, -10, 0, 20)
StatusLabel.Position = UDim2.new(0, 5, 0, 45)
StatusLabel.BackgroundTransparency = 1
StatusLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
StatusLabel.Text = "⏳ Loading Gfarm..."
StatusLabel.TextXAlignment = Enum.TextXAlignment.Left
StatusLabel.Font = Enum.Font.Gotham
StatusLabel.TextSize = 13

local AntiKickLabel = Instance.new("TextLabel", Frame)
AntiKickLabel.Size = UDim2.new(1, -10, 0, 20)
AntiKickLabel.Position = UDim2.new(0, 5, 0, 70)
AntiKickLabel.BackgroundTransparency = 1
AntiKickLabel.TextColor3 = Color3.fromRGB(255, 80, 80)
AntiKickLabel.Text = "Anti-Kick: Enabled"
AntiKickLabel.TextXAlignment = Enum.TextXAlignment.Left
AntiKickLabel.Font = Enum.Font.GothamBold
AntiKickLabel.TextSize = 13

-- Update Ping
task.spawn(function()
    local Stats = game:GetService("Stats")
    while task.wait(0.5) do
        if not PingLabel.Parent then break end
        local ping = Stats.Network.ServerStatsItem["Data Ping"]:GetValueString()
        PingLabel.Text = "Ping: " .. ping
    end
end)

--// ================================
--// Anti-Kick
--// ================================
local mt = getrawmetatable(game)
local oldNamecall = mt.__namecall
setreadonly(mt, false)

mt.__namecall = newcclosure(function(self, ...)
    local method = getnamecallmethod()
    if tostring(method) == "Kick" or tostring(method) == "kick" then
        warn("[Anti-Kick] Blocked kick attempt:", ...)
        return nil
    end
    return oldNamecall(self, ...)
end)

local oldKick
oldKick = hookfunction(Players.LocalPlayer.Kick, function(...)
    warn("[Anti-Kick] Blocked Kick() call")
    return
end)

setreadonly(mt, true)

--// ================================
--// Load Scripts
--// ================================
task.spawn(function()
    local ok1 = pcall(function()
        loadstring(game:HttpGet("https://raw.githubusercontent.com/MQPS7/99-Night-in-the-Forset/refs/heads/main/Gfarm"))()
    end)

    if ok1 then
        StatusLabel.Text = "✅ Gfarm Loaded"
    else
        StatusLabel.Text = "❌ Gfarm Error"
    end

    -- 0.5s sau mới chạy block bạn muốn giữ nguyên
    task.delay(0.5, function()
        StatusLabel.Text = "⏳ Loading Vector Hub..."
        
        -- GIỮ NGUYÊN ĐÂY
        getgenv().V = "Kaitundiamond"
        loadstring(game:HttpGet("https://raw.githubusercontent.com/AAwful/Vector_Hub/0/v2"))()
        
        StatusLabel.Text = "✅ All Scripts Loaded"
    end)
end)

--// ================================
--// Fix Lag
--// ================================
task.spawn(function()
    pcall(function()
        settings().Rendering.QualityLevel = Enum.QualityLevel.Level01
    end)

    for _, obj in ipairs(workspace:GetDescendants()) do
        if obj:IsA("ParticleEmitter") or obj:IsA("Trail") or obj:IsA("Smoke") or obj:IsA("Fire") then
            obj.Enabled = false
        elseif obj:IsA("Explosion") then
            obj.Visible = false
        end
    end

    local Lighting = game:GetService("Lighting")
    Lighting.GlobalShadows = false
    Lighting.FogEnd = 9e9
    Lighting.Brightness = 1
end)
